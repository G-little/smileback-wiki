# 自定义消息格式文档

[TOC]
## 修订记录
----
日期 | 作者 | 修订类型 | 修订内容 | 版本|
---- | ---- | ---- | ---- | ---- |
2020年07月10日|冷立纲|A|新增设计方案|1.0|

> 【修订类型：A-新增  M-修改 D-删除】

## 背景

自定义消息格式文档

## 产品说明

满足产品自定义展示消息

## 关键账户说明


| 用户ID | 身份  |
|:----:|:---:|
| 9999 | 通知 |
| 9998 | 用户通知 |
| 9997 | 官方小二 |



## 接口说明

自定义协议格式说明

``` json

		{
    "SyncOtherMachine": 1, //消息同步至发送方
    "From_Account": "10001",
    "To_Account": "10002",
    "MsgRandom": 1287657,
    "MsgTimeStamp": 5454457,
    "MsgBody": [
        {
            "MsgType": "TIMCustomElem", //自定义消息类型
            "MsgContent": {    
				     "type": 1,  //协议号 依次递增  具体格式参见下面协议定义
				     "version":"1.0", //协议版本号，本地配置目前能处理的版本号，高于该版本则提示需要升级识别		  
				     "tips":"消息会话列表显示提示",
				     "createTime": 1233434343l, //创建时间戳
				     "msg":{                    //消息体
				      "title":"标题", //标题
				      "url":"http://kistalk.com", // h5 广告页面
				      "content":"这是消息内容",
				      "imageUrl":"头图地址", //相对地址，自行追加
				      "coverWidth":300,  //高度
				      "coverHeight":400   //宽度
				      }
            }
        }
    ]
}
		
```




### 1) 文本消息

#### 接口说明

| Type          | 1             |
|:------------- |:-------------:|
| 版本号      |  1.0 |



####  协议说明


```json

      {    
			     "type": 1,  //协议号 依次递增  具体格式参见下面协议定义
			     "version":"1.0", //协议版本号，本地配置目前能处理的版本号，高于该版本则提示需要升级识别	  
			     "tips":"消息会话列表显示提示",
			     "createTime": 1233434343l, //创建时间戳
			     "msg":{                    //文本消息
			         "text":'xxxx'
			      }
        }


```


### 2) 匹配结果通知

#### 接口说明

| Type          | 2            |
|:------------- |:-------------:|
| 版本号      |  1.0 |
| 来源账号      | 9999 |



####  协议说明


```json

      {    
			     "type": 2,  //协议号 依次递增  具体格式参见下面协议定义
			     "version":"1.0", //协议版本号，本地配置目前能处理的版本号，高于该版本则提示需要升级识别	  
			     "tips":"消息会话列表显示提示",
			     "createTime": 1233434343l, //创建时间戳
			     "msg":{                    //文本消息
			         "uid": 12345,
			         "avatar": "/xxx", //头像
			         "roomId": "xxxxxx" //房间号
			      }
        }


```


### 3)  好友匹配成功消息

#### 接口说明

| Type          | 3            |
|:------------- |:-------------:|
| 版本号      |  1.0 |
| 来源账号      | 主动加好友的用户ID |



####  协议说明


```json

      {    
			     "type": 3,  //协议号 依次递增  具体格式参见下面协议定义
			     "version":"1.0", //协议版本号，本地配置目前能处理的版本号，高于该版本则提示需要升级识别	  
			     "tips":"消息会话列表显示提示",
			     "createTime": 1233434343l, //创建时间戳
			     "msg":{                    //文本消息
			         "likePositions":[
			             {
			                 "uid":123,//用户ID
			                 "roomId":123,//房间ID
			                 "roomName":"xxx",//房间名
			                 "imageUrl":"xxx",//房间照片  
			             }
			         ]
			      }
        }


```


### 4)  评论消息

#### 接口说明

| Type          | 4            |
|:------------- |:-------------:|
| 版本号      |  1.0 |
| 来源账号      | 9998 |



####  协议说明


```json

      {    
			     "type": 4,  //协议号 依次递增  具体格式参见下面协议定义
			     "version":"1.0", //协议版本号，本地配置目前能处理的版本号，高于该版本则提示需要升级识别	  
			     "tips":"消息会话列表显示提示",
			     "createTime": 1233434343l, //创建时间戳
			     "msg":{                    //文本消息
			         "avatar": "/xxx", //头像
			         "uid":123, //用户ID
			         "comment": "描述", //用户ID
			         "roomId": "xxx", //房间ID
			         "roomName": "xxx", //房间名
			         "noteId": 123, //留言ID
			         "note": 123 //留言内容
			         "commentId": 123 //留言ID
			      }
        }


```


### 5)  头像审核消息

#### 接口说明

| Type          | 5            |
|:------------- |:-------------:|
| 版本号      |  1.0 |
| 来源账号      | 9999 |



####  协议说明


```json

      {    
			     "type": 5,  //协议号 依次递增  具体格式参见下面协议定义
			     "version":"1.0", //协议版本号，本地配置目前能处理的版本号，高于该版本则提示需要升级识别	  
			     "tips":"消息会话列表显示提示",
			     "createTime": 1233434343l, //创建时间戳
			     "msg":{                    //文本消息
			         "avatar": "/xxx", //头像
			         "status":-1 , // -1 驳回 1 通过
			         "comment": " xxx" // 描述
			      }
        }


```


### 7)  弹幕消息

#### 接口说明

| Type          | 6            |
|:------------- |:-------------:|
| 版本号      |  1.0 |
| 来源账号      | 9999 |



####  协议说明


```json

      {    
			     "type": 6,  //协议号 依次递增  具体格式参见下面协议定义
			     "version":"1.0", //协议版本号，本地配置目前能处理的版本号，高于该版本则提示需要升级识别	  
			     "tips":"消息会话列表显示提示",
			     "createTime": 1233434343l, //创建时间戳
			     "msg":{                    //文本消息
			         "content": " xxx" // 内容
			      }
        }


```