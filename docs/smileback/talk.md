# 直播相关接口

[TOC]
## 修订记录
----
日期 | 作者 | 修订类型 | 修订内容 | 版本|
---- | ---- | ---- | ---- | ---- |
2021年03月04日|冷立纲|A|新增设计方案|1.0|

> 【修订类型：A-新增  M-修改 D-删除】

## 背景

直播相关接口

## 产品说明



## 关键流程说明

## 接口说明


#### 1.0 直播时间校验

##### 接口说明

校验时间

##### 请求说明

| http 请求方式          | get     |
|:------------- |:---------------:|
| url      | /talk/time_check |

#####  输入参数

| 参数          |必选             | 类型       | 参数说明        | 备注          |
|:-------------|:---------------:|:-------------|:-------------|:-------------|
|  roomId      | 是|  string  |  空间ID | |
|  time      | 是|  string  |  时间 | 格式  yyyy-MM-dd HH:mm:ss |

#####  错误说明


#####  返回实例
```json

{
    "c": 0,
    "m": null,
    "d": {
    
    }
}    

```



#### 1.1 直播预约

##### 接口说明

创建预约直播

##### 请求说明

| http 请求方式          | post     |
|:------------- |:---------------:|
| url      | /talk/create |

#####  输入参数

| 参数          |必选             | 类型       | 参数说明        | 备注          |
|:-------------|:---------------:|:-------------|:-------------|:-------------|
|  roomId      | 是|  string  |  空间ID | |
|  mayStartTime      | 是|  string  |  时间 | 格式  yyyy-MM-dd HH:mm |
|  content      | 是|  string  |  时间 | 主题 |

#####  错误说明


#####  返回实例
```json

{
    "c": 0,
    "m": null,
    "d": {
    
    }
}    

```


#### 1.2 直播预约

##### 接口说明

创建预约直播

##### 请求说明

| http 请求方式          | post     |
|:------------- |:---------------:|
| url      | /talk/create |

#####  输入参数

| 参数          |必选             | 类型       | 参数说明        | 备注          |
|:-------------|:---------------:|:-------------|:-------------|:-------------|
|  roomId      | 是|  string  |  空间ID | |
|  mayStartTime      | 是|  string  |  时间 | 格式  yyyy-MM-dd HH:mm |
|  content      | 是|  string  |  时间 | 主题 |

#####  错误说明


#####  返回实例
```json

{
    "c": 0,
    "m": null,
    "d": {
    
    }
}    

```


#### 1.3 直播列表

##### 接口说明

直播列表

##### 请求说明

| http 请求方式          | get     |
|:------------- |:---------------:|
| url      | /talk/list |

#####  输入参数

| 参数          |必选             | 类型       | 参数说明        | 备注          |
|:-------------|:---------------:|:-------------|:-------------|:-------------|
|  roomId      | 是|  string  |  空间ID | |
| page      | 否| int  | 分页|   |
| limit      | 否| int  | 单页条数|   |

#####  错误说明


#####  返回实例
```json

{
    "c": 0,
    "m": null,
    "d": {
    
    }
}    

```


#### 1.4 取消直播

##### 接口说明

取消直播

##### 请求说明

| http 请求方式          | post     |
|:------------- |:---------------:|
| url      | /talk/cancel |

#####  输入参数

| 参数          |必选             | 类型       | 参数说明        | 备注          |
|:-------------|:---------------:|:-------------|:-------------|:-------------|
|  id      | 是|  int  |  直播ID | |

#####  错误说明


#####  返回实例
```json

{
    "c": 0,
    "m": null,
    "d": {
    
    }
}    

```



#### 1.4 邀请用户

##### 接口说明

邀请用户

##### 请求说明

| http 请求方式          | post     |
|:------------- |:---------------:|
| url      | /talk/invite |

#####  输入参数

| 参数          |必选             | 类型       | 参数说明        | 备注          |
|:-------------|:---------------:|:-------------|:-------------|:-------------|
|  id      | 是|  int  |  直播ID | |
|  type      | 是|  int  |  邀请类型 | 1 普通邀请 2 邀请上麦  |

#####  错误说明


#####  返回实例
```json

{
    "c": 0,
    "m": null,
    "d": {
    
    }
}    

```



#### 1.4 接受邀请

##### 接口说明

邀请用户

##### 请求说明

| http 请求方式          | post     |
|:------------- |:---------------:|
| url      | /talk/invite/accept |

#####  输入参数

| 参数          |必选             | 类型       | 参数说明        | 备注          |
|:-------------|:---------------:|:-------------|:-------------|:-------------|
|  id      | 是|  int  |  邀请ID | |

#####  错误说明


#####  返回实例
```json

{
    "c": 0,
    "m": null,
    "d": {
    
    }
}    

```



#### 1.5 邀请码信息转换

##### 接口说明

邀请码

* 1. code 以 `^A` 开头代表空间邀请
* 2. code 以 `^B` 开头代表直播邀请

##### 请求说明

| http 请求方式          | post     |
|:------------- |:---------------:|
| url      | /invite/code2data |

#####  输入参数

| 参数          |必选             | 类型       | 参数说明        | 备注          |
|:-------------|:---------------:|:-------------|:-------------|:-------------|
|  code      | 是|  string  |  邀请码 | |

#####  错误说明


#####  返回实例

**`^B`开头直播邀请**

```json

{
    "c": 0,
    "m": null,
    "d": {
        "id":1, //邀请ID
        "talkId":2, //直播ID
        "content":"直播内容", //直播标题
        "mayStartTime": 1233555, //直播开始时间毫秒值
        "status": 0, //直播状态   0 预约 1 开始 -1 结束 -2 取消 
        "type": 1, // 邀请类型 1 普通 2 上麦
        "roomId": "空间ID", // 空间ID
        "name": "空间名称", // 空间名称
        "uid": 2222, // 用户ID
        "avatar": "/b", // 用户头像
    
    }
}    

```



#### 1.6 举手

##### 接口说明


##### 请求说明

| http 请求方式          | post     |
|:------------- |:---------------:|
| url      | /talk/handup |

#####  输入参数

| 参数          |必选             | 类型       | 参数说明        | 备注          |
|:-------------|:---------------:|:-------------|:-------------|:-------------|
|  id      | 是|  int  |  直播ID | |
|  roomId      | 是|  string  |  用户所在子空间ID | |


#####  错误说明


#####  返回实例

**`^B`开头直播邀请**

```json

{
    "c": 0,
    "m": null,
    "d": {
            
    }
}    

```


#### 1.7 取消举手

##### 接口说明


##### 请求说明

| http 请求方式          | post     |
|:------------- |:---------------:|
| url      | /talk/handdown |

#####  输入参数

| 参数          |必选             | 类型       | 参数说明        | 备注          |
|:-------------|:---------------:|:-------------|:-------------|:-------------|
|  id      | 是|  int  |  直播ID | |


#####  错误说明


#####  返回实例

**`^B`开头直播邀请**

```json

{
    "c": 0,
    "m": null,
    "d": {
            
    }
}    

```


#### 1.8 举手列表

##### 接口说明


##### 请求说明

| http 请求方式          | get     |
|:------------- |:---------------:|
| url      | /talk/handup/list |

#####  输入参数

| 参数          |必选             | 类型       | 参数说明        | 备注          |
|:-------------|:---------------:|:-------------|:-------------|:-------------|
|  id      | 是|  int  |  直播ID | |
| page      | 否| int  | 分页|   |
| limit      | 否| int  | 单页条数|   |



#####  错误说明


#####  返回实例

```json

{
    "c": 0,
    "m": null,
    "d": {
        "pageSize": 10,
        "total": 1,
        "currentPage": 1,
        "list": [
            {
                "id": null,
                "roomId": null,
                "uid": 11632,
                "avatar": null,
                "certStatus": null,
                "level": 1,
                "times": 0,
                "addTime": null
            }
        ],
        "end": true,
        "empty": false,
        "startIndex": 0,
        "totalPage": 1
    }
}   

```




#### 1.9 订阅直播

##### 接口说明


##### 请求说明

| http 请求方式          | post     |
|:------------- |:---------------:|
| url      | /talk/subscribe |

#####  输入参数

| 参数          |必选             | 类型       | 参数说明        | 备注          |
|:-------------|:---------------:|:-------------|:-------------|:-------------|
|  id      | 是|  int  |  直播ID | |
| value      | 是 | boolean  |  用户角色 |   true 订阅  fasle 取消订阅  |



#####  错误说明


#####  返回实例

```json

{
    "c": 0,
    "m": null,
    "d": {
            
    }
}    

```



#### 1.10 订阅直播

##### 接口说明


##### 请求说明

| http 请求方式          | post     |
|:------------- |:---------------:|
| url      | /talk/subscribe |

#####  输入参数

| 参数          |必选             | 类型       | 参数说明        | 备注          |
|:-------------|:---------------:|:-------------|:-------------|:-------------|
|  id      | 是|  int  |  直播ID | |
| value      | 是 | boolean  |  用户角色 |   true 订阅  fasle 取消订阅  |



#####  错误说明


#####  返回实例

```json

{
    "c": 0,
    "m": null,
    "d": {
            
    }
}    

```



#### 1.11 查询直播用户信息

##### 接口说明


##### 请求说明

| http 请求方式          | get     |
|:------------- |:---------------:|
| url      | /talk/user_info |

#####  输入参数

| 参数          |必选             | 类型       | 参数说明        | 备注          |
|:-------------|:---------------:|:-------------|:-------------|:-------------|
|  id      | 是|  int  |  直播ID | |
| uids      | 是 | int[]  |  用户id数组 |   |



#####  错误说明


#####  返回实例

```json

{
    "c": 0,
    "m": null,
    "d": [
            {
                "id": null,
                "roomId": null,
                "uid": 11632,
                "avatar": null,
                "certStatus": null,
                "level": 1,
                "times": 0,
                "addTime": null
            }
        ]
}    

```










